<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Grade 1 IMC Practice Test</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  .question-box { margin: 20px 0; }
  .options label { display: block; margin-bottom: 10px; }
  .btn { padding: 10px 20px; margin: 10px; cursor: pointer; }
  .end-test { position: fixed; top: 20px; right: 20px; background: red; color: white; border: none; cursor: pointer; }
  .score { font-size: 1.5em; margin-top: 20px; font-weight: bold; color: #333; }
  .correct { color: green; margin-bottom: 5px; }
  .wrong { color: red; margin-bottom: 5px; }
  .result-summary { background: #f0f8ff; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
  .title { font-size: 1.8em; font-weight: bold; margin-top: 10px; }
  .title.elitist { color: darkblue; }
  .title.champion { color: darkgreen; }
  .final-results { margin-top: 20px; }
</style>
</head>
<body>

<h1>Grade 1 IMC Practice Test</h1>
<div id="timer">Time left: 45:00</div>
<button class="end-test" onclick="endTest()">End Test</button>

<div id="question-container"></div>
<button class="btn" onclick="prevQuestion()">‚¨Ö Back</button>
<button class="btn" onclick="submitAnswer()">Submit & Next ‚û°</button>

<div id="result-container" style="display:none;"></div>

<script>
let questions = [];
let shuffledQuestions = [];
let currentIndex = 0;
let userAnswers = [];
let timer = 45 * 60; // 45 minutes
let timerInterval;

// Sample questions for demonstration - replace with your JSON file
const sampleQuestions = [
  {
    question: "What is 2 + 3?",
    options: ["4", "5", "6", "7"],
    answer: "5"
  },
  {
    question: "Which is bigger: 8 or 5?",
    options: ["8", "5", "They are equal"],
    answer: "8"
  },
  {
    question: "How many sides does a triangle have?",
    options: ["2", "3", "4", "5"],
    answer: "3"
  },
  // Add more questions here...
];

// Initialize the test
function initializeTest() {
  questions = sampleQuestions; // Replace with your JSON loading
  shuffledQuestions = questions.sort(() => 0.5 - Math.random()).slice(0, 20);
  userAnswers = Array(shuffledQuestions.length).fill(null);
  currentIndex = 0;
  showQuestion(currentIndex);
  startTimer();
}

// Uncomment this section when you have your JSON file
/*
fetch('imc_grade1_questions.json')
  .then(response => response.json())
  .then(data => {
    questions = data;
    shuffledQuestions = questions.sort(() => 0.5 - Math.random()).slice(0, 20);
    userAnswers = Array(shuffledQuestions.length).fill(null);
    showQuestion(currentIndex);
    startTimer();
  })
  .catch(error => {
    console.error('Error loading questions:', error);
    alert('Could not load questions. Please check if imc_grade1_questions.json exists.');
  });
*/

function startTimer() {
  const timerEl = document.getElementById('timer');
  timerInterval = setInterval(() => {
    const min = String(Math.floor(timer / 60)).padStart(2, '0');
    const sec = String(timer % 60).padStart(2, '0');
    timerEl.textContent = `Time left: ${min}:${sec}`;
    if (timer <= 0) {
      clearInterval(timerInterval);
      endTest();
      return;
    }
    timer--;
  }, 1000);
}

function showQuestion(index) {
  if (index >= shuffledQuestions.length) {
    endTest();
    return;
  }
  
  const q = shuffledQuestions[index];
  let html = `<div class="question-box"><strong>Q${index + 1} of ${shuffledQuestions.length}:</strong> ${q.question}</div>`;
  html += '<div class="options">';
  q.options.forEach(opt => {
    const checked = userAnswers[index] === opt ? 'checked' : '';
    html += `<label><input type="radio" name="option" value="${opt}" ${checked}> ${opt}</label>`;
  });
  html += '</div>';
  document.getElementById('question-container').innerHTML = html;
}

function submitAnswer() {
  const selected = document.querySelector('input[name="option"]:checked');
  if (!selected) {
    alert('Please select an answer!');
    return;
  }
  userAnswers[currentIndex] = selected.value;
  if (currentIndex < shuffledQuestions.length - 1) {
    currentIndex++;
    showQuestion(currentIndex);
  } else {
    endTest();
  }
}

function prevQuestion() {
  if (currentIndex > 0) {
    currentIndex--;
    showQuestion(currentIndex);
  }
}

function endTest() {
  // Clear the timer
  if (timerInterval) {
    clearInterval(timerInterval);
  }
  
  let score = 0;
  let html = '<h2>üéâ Test Completed! üéâ</h2>';
  
  shuffledQuestions.forEach((q, i) => {
    const userAns = userAnswers[i];
    const correct = q.answer;
    const cls = userAns === correct ? 'correct' : 'wrong';
    if (userAns === correct) score++;
    html += `<div class="${cls}">Q${i+1}: ${q.question}<br>
             Your answer: ${userAns || 'No answer'}<br>
             Correct answer: ${correct}</div><hr>`;
  });

  // Calculate percentage and assign title
  const totalQuestions = shuffledQuestions.length;
  const percent = (score / totalQuestions) * 100;
  let titleHtml = '';
  if (percent >= 95) {
    titleHtml = `<div class="title champion">üèÜ CHAMPION üèÜ</div>`;
  } else if (percent >= 80) {
    titleHtml = `<div class="title elitist">üåü ELITIST üåü</div>`;
  } else {
    titleHtml = `<div class="title" style="color: orange;">üëç Good effort! üëç</div>`;
  }

  const summaryHtml = `
    <div class="result-summary">
      <div class="score">Your score: ${score} / ${totalQuestions} (${percent.toFixed(1)}%)</div>
      ${titleHtml}
    </div>
  `;

  html = summaryHtml + `<div class="final-results">${html}</div>`;
  document.getElementById('result-container').innerHTML = html;
  document.getElementById('result-container').style.display = 'block';
  document.getElementById('question-container').style.display = 'none';
  document.querySelectorAll('.btn, .end-test').forEach(btn => btn.style.display = 'none');
}

// Initialize the test when page loads
initializeTest();
</script>

</body>
</html>
